<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Settings - Bookmarks by Localforge</title>
  <link rel="stylesheet" href="options.css">
</head>
<body class="app-layout">
  <!-- Header container - will be populated by createHeaderNav -->
  <div id="headerNav"></div>

  <div class="app-layout__content">
  <div class="settings-layout">
    <!-- Sidebar Navigation (Desktop only) -->
    <aside class="settings-sidebar">
      <div class="sidebar-header">SECTIONS</div>
      <nav class="sidebar-nav">
        <a href="#appearance" class="nav-item active" data-section="appearance">
          <span class="nav-indicator">‚óè</span>
          <span class="nav-label">Appear.</span>
        </a>
        <a href="#api-config" class="nav-item" data-section="api-config">
          <span class="nav-indicator">‚óã</span>
          <span class="nav-label">API</span>
        </a>
        <a href="#data-management" class="nav-item" data-section="data-management">
          <span class="nav-indicator">‚óã</span>
          <span class="nav-label">Data</span>
        </a>
        <a href="#about" class="nav-item" data-section="about">
          <span class="nav-indicator">‚óã</span>
          <span class="nav-label">About</span>
        </a>
      </nav>
    </aside>

    <!-- Main Content -->
    <div class="settings-content">
      <main>
        <div id="status" class="status hidden"></div>

        <section id="appearance" class="settings-section">
          <h2 class="section-title">APPEARANCE</h2>
          <div class="section-divider"></div>
          <div class="theme-section">
        <h3>Theme</h3>
        <p class="section-description">
          Choose your preferred appearance. Auto follows system.
        </p>
        <div class="theme-options">
          <div class="theme-option">
            <input type="radio" id="themeAuto" name="theme" value="auto" checked>
            <label for="themeAuto">
              <div class="theme-preview auto"></div>
              <span class="theme-name">Auto</span>
            </label>
          </div>
          <div class="theme-option">
            <input type="radio" id="themeLight" name="theme" value="light">
            <label for="themeLight">
              <div class="theme-preview light">A</div>
              <span class="theme-name">Light</span>
            </label>
          </div>
          <div class="theme-option">
            <input type="radio" id="themeDark" name="theme" value="dark">
            <label for="themeDark">
              <div class="theme-preview dark">A</div>
              <span class="theme-name">Dark</span>
            </label>
          </div>
          <div class="theme-option">
            <input type="radio" id="themeTerminal" name="theme" value="terminal">
            <label for="themeTerminal">
              <div class="theme-preview terminal">&gt;_</div>
              <span class="theme-name">Terminal</span>
            </label>
          </div>
          <div class="theme-option">
            <input type="radio" id="themeTufte" name="theme" value="tufte">
            <label for="themeTufte">
              <div class="theme-preview tufte">Aa</div>
              <span class="theme-name">Tufte</span>
            </label>
          </div>
        </div>
          </div>
        </section>

        <section id="api-config" class="settings-section">
          <h2 class="section-title">API CONFIGURATION</h2>
          <div class="section-divider"></div>
          <form id="settingsForm">
        <div class="form-group">
          <label for="apiBaseUrl">API Base URL</label>
          <input
            type="url"
            id="apiBaseUrl"
            name="apiBaseUrl"
            placeholder="https://api.openai.com/v1"
            required
          />
          <small class="help-text">
            OpenAI-compatible API endpoint. For OpenAI, use the default.
            For local models, use your local endpoint (e.g., http://localhost:1234/v1)
          </small>
        </div>

        <div class="form-group">
          <label for="apiKey">API Key</label>
          <input
            type="password"
            id="apiKey"
            name="apiKey"
            placeholder="sk-..."
            required
          />
          <small class="help-text">
            Your OpenAI API key or compatible provider key
          </small>
        </div>

        <div class="form-group">
          <label for="chatModel">Chat Model</label>
          <input
            type="text"
            id="chatModel"
            name="chatModel"
            placeholder="gpt-4o-mini"
            required
          />
          <small class="help-text">
            Model for Q&A generation (e.g., gpt-4o-mini, gpt-4o)
          </small>
        </div>

        <div class="form-group">
          <label for="embeddingModel">Embedding Model</label>
          <input
            type="text"
            id="embeddingModel"
            name="embeddingModel"
            placeholder="text-embedding-3-small"
            required
          />
          <small class="help-text">
            Model for generating embeddings (e.g., text-embedding-3-small)
          </small>
        </div>

        <div class="button-group">
          <button type="submit" class="btn btn-primary">
            Save Settings
          </button>
          <button type="button" id="testBtn" class="btn btn-secondary">
            Test Connection
          </button>
        </div>
          </form>
        </section>

        <section id="data-management" class="settings-section">
          <h2 class="section-title">DATA MANAGEMENT</h2>
          <div class="section-divider"></div>

          <!-- Import -->
          <div class="subsection">
            <h3>Import</h3>
            <div class="data-actions">
              <div class="data-action">
                <input type="file" id="importFile" accept=".json" class="file-input" />
                <label for="importFile" class="btn btn-secondary file-label">
                  üìÅ Import from File
                </label>
                <span id="importFileName" class="file-name"></span>
                <button type="button" id="importBtn" class="btn btn-primary" disabled>
                  Import
                </button>
              </div>
              <div class="data-action">
                <button type="button" id="showBulkImport" class="btn btn-secondary">
                  üîó Import URLs
                </button>
              </div>
            </div>
            <div id="importStatus" class="import-status hidden"></div>

            <!-- Bulk Import (initially hidden) -->
            <div id="bulkImportContainer" class="bulk-import-container hidden" style="margin-top: var(--space-5);">
              <h4>Import URLs</h4>
              <p class="section-description">
                Paste URLs (one per line) to import multiple bookmarks at once.
              </p>
              <textarea
                id="bulkUrlsInput"
                rows="10"
                placeholder="https://example.com/article1&#10;https://example.com/article2&#10;https://github.com/user/repo"
              ></textarea>
              <div id="urlValidationFeedback" class="validation-feedback"></div>
              <div class="button-group">
                <button type="button" id="startBulkImport" class="btn btn-primary" disabled>
                  Import URLs
                </button>
                <button type="button" id="cancelBulkImport" class="btn btn-secondary" style="display:none;">
                  Cancel
                </button>
              </div>
              <div id="bulkImportProgress" class="bulk-import-progress hidden">
                <div class="progress-bar-container">
                  <div id="bulkImportProgressBar" class="progress-bar"></div>
                </div>
                <span id="bulkImportStatus" class="progress-status">Processing...</span>
              </div>
            </div>
          </div>

          <div class="section-divider"></div>

          <!-- Export -->
          <div class="subsection">
            <h3>Export</h3>
            <div class="data-actions">
              <div class="data-action">
                <button type="button" id="exportAllBtn" class="btn btn-secondary">
                  ‚≠ï Export All
                </button>
              </div>
              <div class="data-action">
                <button type="button" id="exportSettingsBtn" class="btn btn-secondary">
                  ‚≠ï Export Settings
                </button>
              </div>
            </div>
          </div>

          <div class="section-divider"></div>

          <!-- Processing Queue -->
          <div class="subsection">
            <h3>Processing Queue</h3>
            <p class="section-description">
              Active and pending processing jobs.
            </p>
            <div class="jobs-controls">
              <div class="jobs-filters">
                <select id="jobTypeFilter" class="filter-select">
                  <option value="">All Types</option>
                  <option value="manual_add">Manual Add</option>
                  <option value="markdown_generation">Markdown Generation</option>
                  <option value="qa_generation">Q&A Generation</option>
                  <option value="file_import">File Import</option>
                  <option value="bulk_url_import">Bulk URL Import</option>
                  <option value="url_fetch">URL Fetch</option>
                </select>
                <select id="jobStatusFilter" class="filter-select">
                  <option value="">All Status</option>
                  <option value="pending">Pending</option>
                  <option value="in_progress">In Progress</option>
                  <option value="completed">Completed</option>
                  <option value="failed">Failed</option>
                  <option value="cancelled">Cancelled</option>
                </select>
              </div>
              <button type="button" id="refreshJobsBtn" class="btn btn-secondary">
                Refresh
              </button>
            </div>
            <div id="jobsList" class="jobs-list">
              <div class="loading">Loading jobs...</div>
            </div>
          </div>
        </section>

        <section id="about" class="settings-section">
          <h2 class="section-title">ABOUT</h2>
          <div class="section-divider"></div>
          <div class="info-section">
        <h3>Bookmarks by Localforge</h3>
        <p class="version-info">Version 3.4.0</p>

        <div class="section-divider"></div>

        <p>
          Your bookmarks are stored locally. Only extracted content is sent to your configured API.
        </p>

        <div class="about-links">
          <a href="https://localforge.dev" target="_blank" class="btn btn-secondary">Website</a>
          <a href="https://github.com/localforge/bookmarks" target="_blank" class="btn btn-secondary">Source code</a>
          <a href="https://github.com/localforge/bookmarks/issues" target="_blank" class="btn btn-secondary">Report Issue</a>
        </div>
          </div>
        </section>
      </main>
    </div>
  </div>
  </div>

  <script src="options.ts" type="module"></script>
</body>
</html>
